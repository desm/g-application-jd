add system tests and make all tests pass
